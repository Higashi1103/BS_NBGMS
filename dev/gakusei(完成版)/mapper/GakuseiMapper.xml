<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.example.demo.mapper.GakuseiMapper">
  

  <!-- 学生表(gakusei)的基础映射(BaseResultMap) -->
  <resultMap id="BaseResultMap" type="com.example.demo.entity.Gakusei"> 
    <id column="gakusei_id" jdbcType="INTEGER" property="gakuseiId" />
    <result column="kurasu_id" jdbcType="INTEGER" property="kurasuId" />
    <result column="namae" jdbcType="VARCHAR" property="namae" />
    <result column="seibetsu" jdbcType="VARCHAR" property="seibetsu" />
    <result column="seinengappi" jdbcType="VARCHAR" property="seinengappi" />
    <result column="saishu_gakureki" jdbcType="VARCHAR" property="saishuGakureki" />
    <result column="gogakuryoku" jdbcType="VARCHAR" property="gogakuryoku" />
    <result column="tensu" jdbcType="INTEGER" property="tensu" />
    <result column="hyouka" jdbcType="VARCHAR" property="hyouka" />
    <result column="sonota" jdbcType="VARCHAR" property="sonota" />
    <result column="yobi1" jdbcType="VARCHAR" property="yobi1" />
    <result column="yobi2" jdbcType="VARCHAR" property="yobi2" />
    <result column="yobi3" jdbcType="VARCHAR" property="yobi3" />
    <result column="DELETE_FLAG" jdbcType="INTEGER" property="deleteFlag" />
  </resultMap>
  
  <!-- (学生表 + 班级表 + 分数履历表) 映射 -->
  <resultMap id="GakuseiKurasuTensuFullMap" type="com.example.demo.entity.Gakusei">

  <!-- gakusei (学生表) -->
  <id column="gakusei_id" jdbcType="INTEGER" property="gakuseiId"/>
  <result column="kurasu_id" jdbcType="INTEGER" property="kurasuId"/>
  <result column="namae" jdbcType="VARCHAR" property="namae"/>
  <result column="seibetsu" jdbcType="VARCHAR" property="seibetsu"/>
  <result column="seinengappi" jdbcType="VARCHAR" property="seinengappi"/>
  <result column="saishu_gakureki" jdbcType="VARCHAR" property="saishuGakureki"/>
  <result column="gogakuryoku" jdbcType="VARCHAR" property="gogakuryoku"/>
  <result column="tensu" jdbcType="INTEGER" property="tensu"/>
  <result column="hyouka" jdbcType="VARCHAR" property="hyouka"/>
  <result column="sonota" jdbcType="VARCHAR" property="sonota"/>
  <result column="yobi1" jdbcType="VARCHAR" property="yobi1"/>
  <result column="yobi2" jdbcType="VARCHAR" property="yobi2"/>
  <result column="yobi3" jdbcType="VARCHAR" property="yobi3"/>
  <result column="DELETE_FLAG" jdbcType="INTEGER" property="deleteFlag"/>

  <!-- kurasu_info (班级表) -->
  <result column="KURASU_NAMAE" jdbcType="VARCHAR" property="kurasuNamae"/>
  
  <!-- tensu_henkou_rireki (分数变更履历表) -->
  <result column="kagen_tensu" jdbcType="VARCHAR" property="kagenTensu"/>

</resultMap>

	<!-- 三表联查 : 学生一览表画面内容 -->
	<select id="getGakuseiKurasuTensuList"
			parameterType="com.example.demo.entity.Gakusei"
			resultMap="GakuseiKurasuTensuFullMap">
	
	SELECT
		g.gakusei_id,
		g.namae,
		g.seibetsu,
		g.tensu,
		k.kurasu_namae,
		t.kagen_tensu
	FROM gakusei AS g
	LEFT JOIN kurasu_info AS k
		ON g.kurasu_id = k.kurasu_id
	LEFT JOIN tensu_henkou_rireki AS t
		ON g.gakusei_id = t.gakusei_id
	WHERE g.DELETE_FLAG = 0
	ORDER BY g.gakusei_id
	
	</select>
	
	<!-- 三表联查 : 学生詳細画面内容 -->
	<select id="getGakuseiDetail"
			parameterType="com.example.demo.entity.Gakusei"
			resultMap="GakuseiKurasuTensuFullMap">
	
	SELECT
		g.gakusei_id,
		g.namae,
		g.seibetsu,
		g.seinengappi,
		g.saishu_gakureki,
		g.gogakuryoku,
		g.hyouka,
		g.sonota,
		g.tensu,
		k.kurasu_namae,
		t.kagen_tensu
	FROM gakusei AS g
	LEFT JOIN kurasu_info AS k
		ON g.kurasu_id = k.kurasu_id
	LEFT JOIN tensu_henkou_rireki AS t
		ON g.gakusei_id = t.gakusei_id
	WHERE g.DELETE_FLAG = 0
		AND g.gakusei_id = #{gakuseiId}
		
	</select>
	
	<!-- 查班级表 : 学生新规画面-放大镜功能 -->
	<select id="searchByKurasuNamae"
			parameterType="String"
			resultType="com.example.demo.entity.Gakusei">
			
	SELECT
		kurasu_id,
		kurasu_namae
	FROM kurasu_info
	WHERE kurasu_namae LIKE CONCAT('%',#{kurasuNamae},'%')
	
	</select>
	
	<!-- 三表联查 : 显示更新画面内容 -->
	<select id="getGakuseiById"
			parameterType="com.example.demo.entity.Gakusei"
			resultMap="GakuseiKurasuTensuFullMap">
	
	SELECT
		g.gakusei_id,
		g.namae,
		g.seibetsu,
		g.seinengappi,
		g.saishu_gakureki,
		g.gogakuryoku,
		g.hyouka,
		g.sonota,
		g.tensu,
		k.kurasu_namae,
		t.kagen_tensu
	FROM gakusei AS g
	LEFT JOIN kurasu_info AS k
		ON g.kurasu_id = k.kurasu_id
	LEFT JOIN tensu_henkou_rireki AS t
		ON g.gakusei_id = t.gakusei_id
	WHERE g.DELETE_FLAG = 0
		AND g.gakusei_id = #{gakuseiId}
		
	</select>
	
	<!-- 学生情报更新处理 -->
	<update id="updateGakuseiInfo"
			parameterType="com.example.demo.entity.Gakusei">
			
			UPDATE gakusei
			<set>
				<if test="namae != null">namae = #{namae},</if>
        		<if test="seibetsu != null">seibetsu = #{seibetsu},</if>
        		<if test="seinengappi != null">seinengappi = #{seinengappi},</if>
        		<if test="saishuGakureki != null">saishu_gakureki = #{saishuGakureki},</if>
        		<if test="gogakuryoku != null">gogakuryoku = #{gogakuryoku},</if>
        		<if test="tensu != null">tensu = #{tensu},</if>
        		<if test="hyouka != null">hyouka = #{hyouka},</if>
        		<if test="sonota != null">sonota = #{sonota},</if>
        		<if test="kurasuId != null">kurasu_id = #{kurasuId},</if>
			</set>	
			WHERE gakusei_id = #{gakuseiId}
			
	</update>
	
	<!-- 论理删除 -->
	<update id="deleteGakuseiInfo" parameterType="int">
    		UPDATE gakusei
    		SET delete_flag = 1
    		WHERE gakusei_id = #{gakuseiId}
	</update>
	
  <!-- Mybatis 自动生成的，不要动！ -->
  <sql id="Example_Where_Clause">
    
    <where>
      <foreach collection="oredCriteria" item="criteria" separator="or">
        <if test="criteria.valid">
          <trim prefix="(" prefixOverrides="and" suffix=")">
            <foreach collection="criteria.criteria" item="criterion">
              <choose>
                <when test="criterion.noValue">
                  and ${criterion.condition}
                </when>
                <when test="criterion.singleValue">
                  and ${criterion.condition} #{criterion.value}
                </when>
                <when test="criterion.betweenValue">
                  and ${criterion.condition} #{criterion.value} and #{criterion.secondValue}
                </when>
                <when test="criterion.listValue">
                  and ${criterion.condition}
                  <foreach close=")" collection="criterion.value" item="listItem" open="(" separator=",">
                    #{listItem}
                  </foreach>
                </when>
              </choose>
            </foreach>
          </trim>
        </if>
      </foreach>
    </where>
  </sql>
  <sql id="Update_By_Example_Where_Clause">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Thu Oct 23 21:46:57 JST 2025.
    -->
    <where>
      <foreach collection="example.oredCriteria" item="criteria" separator="or">
        <if test="criteria.valid">
          <trim prefix="(" prefixOverrides="and" suffix=")">
            <foreach collection="criteria.criteria" item="criterion">
              <choose>
                <when test="criterion.noValue">
                  and ${criterion.condition}
                </when>
                <when test="criterion.singleValue">
                  and ${criterion.condition} #{criterion.value}
                </when>
                <when test="criterion.betweenValue">
                  and ${criterion.condition} #{criterion.value} and #{criterion.secondValue}
                </when>
                <when test="criterion.listValue">
                  and ${criterion.condition}
                  <foreach close=")" collection="criterion.value" item="listItem" open="(" separator=",">
                    #{listItem}
                  </foreach>
                </when>
              </choose>
            </foreach>
          </trim>
        </if>
      </foreach>
    </where>
  </sql>
  <sql id="Base_Column_List">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Thu Oct 23 21:46:57 JST 2025.
    -->
    gakusei_id, kurasu_id, namae, seibetsu, seinengappi, saishu_gakureki, gogakuryoku, 
    tensu, hyouka, sonota, yobi1, yobi2, yobi3, DELETE_FLAG
  </sql>
  <select id="selectByExample" parameterType="com.example.demo.entity.GakuseiExample" resultMap="BaseResultMap">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Thu Oct 23 21:46:57 JST 2025.
    -->
    select
    <if test="distinct">
      distinct
    </if>
    <include refid="Base_Column_List" />
    from gakusei
    <if test="_parameter != null">
      <include refid="Example_Where_Clause" />
    </if>
    <if test="orderByClause != null">
      order by ${orderByClause}
    </if>
  </select>
  <select id="selectByPrimaryKey" parameterType="java.lang.Integer" resultMap="BaseResultMap">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Thu Oct 23 21:46:57 JST 2025.
    -->
    select 
    <include refid="Base_Column_List" />
    from gakusei
    where gakusei_id = #{gakuseiId,jdbcType=INTEGER}
  </select>
  <delete id="deleteByPrimaryKey" parameterType="java.lang.Integer">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Thu Oct 23 21:46:57 JST 2025.
    -->
    delete from gakusei
    where gakusei_id = #{gakuseiId,jdbcType=INTEGER}
  </delete>
  <delete id="deleteByExample" parameterType="com.example.demo.entity.GakuseiExample">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Thu Oct 23 21:46:57 JST 2025.
    -->
    delete from gakusei
    <if test="_parameter != null">
      <include refid="Example_Where_Clause" />
    </if>
  </delete>
  <insert id="insert" parameterType="com.example.demo.entity.Gakusei">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Thu Oct 23 21:46:57 JST 2025.
    -->
    insert into gakusei (gakusei_id, kurasu_id, namae, 
      seibetsu, seinengappi, saishu_gakureki, 
      gogakuryoku, tensu, hyouka, 
      sonota, yobi1, yobi2, 
      yobi3, DELETE_FLAG)
    values (#{gakuseiId,jdbcType=INTEGER}, #{kurasuId,jdbcType=INTEGER}, #{namae,jdbcType=VARCHAR}, 
      #{seibetsu,jdbcType=VARCHAR}, #{seinengappi,jdbcType=VARCHAR}, #{saishuGakureki,jdbcType=VARCHAR}, 
      #{gogakuryoku,jdbcType=VARCHAR}, #{tensu,jdbcType=INTEGER}, #{hyouka,jdbcType=VARCHAR}, 
      #{sonota,jdbcType=VARCHAR}, #{yobi1,jdbcType=VARCHAR}, #{yobi2,jdbcType=VARCHAR}, 
      #{yobi3,jdbcType=VARCHAR}, #{deleteFlag,jdbcType=INTEGER})
  </insert>
  <insert id="insertSelective" parameterType="com.example.demo.entity.Gakusei">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Thu Oct 23 21:46:57 JST 2025.
    -->
    insert into gakusei
    <trim prefix="(" suffix=")" suffixOverrides=",">
      <if test="gakuseiId != null">
        gakusei_id,
      </if>
      <if test="kurasuId != null">
        kurasu_id,
      </if>
      <if test="namae != null">
        namae,
      </if>
      <if test="seibetsu != null">
        seibetsu,
      </if>
      <if test="seinengappi != null">
        seinengappi,
      </if>
      <if test="saishuGakureki != null">
        saishu_gakureki,
      </if>
      <if test="gogakuryoku != null">
        gogakuryoku,
      </if>
      <if test="tensu != null">
        tensu,
      </if>
      <if test="hyouka != null">
        hyouka,
      </if>
      <if test="sonota != null">
        sonota,
      </if>
      <if test="yobi1 != null">
        yobi1,
      </if>
      <if test="yobi2 != null">
        yobi2,
      </if>
      <if test="yobi3 != null">
        yobi3,
      </if>
      <if test="deleteFlag != null">
        DELETE_FLAG,
      </if>
    </trim>
    <trim prefix="values (" suffix=")" suffixOverrides=",">
      <if test="gakuseiId != null">
        #{gakuseiId,jdbcType=INTEGER},
      </if>
      <if test="kurasuId != null">
        #{kurasuId,jdbcType=INTEGER},
      </if>
      <if test="namae != null">
        #{namae,jdbcType=VARCHAR},
      </if>
      <if test="seibetsu != null">
        #{seibetsu,jdbcType=VARCHAR},
      </if>
      <if test="seinengappi != null">
        #{seinengappi,jdbcType=VARCHAR},
      </if>
      <if test="saishuGakureki != null">
        #{saishuGakureki,jdbcType=VARCHAR},
      </if>
      <if test="gogakuryoku != null">
        #{gogakuryoku,jdbcType=VARCHAR},
      </if>
      <if test="tensu != null">
        #{tensu,jdbcType=INTEGER},
      </if>
      <if test="hyouka != null">
        #{hyouka,jdbcType=VARCHAR},
      </if>
      <if test="sonota != null">
        #{sonota,jdbcType=VARCHAR},
      </if>
      <if test="yobi1 != null">
        #{yobi1,jdbcType=VARCHAR},
      </if>
      <if test="yobi2 != null">
        #{yobi2,jdbcType=VARCHAR},
      </if>
      <if test="yobi3 != null">
        #{yobi3,jdbcType=VARCHAR},
      </if>
      <if test="deleteFlag != null">
        #{deleteFlag,jdbcType=INTEGER},
      </if>
    </trim>
  </insert>
  <select id="countByExample" parameterType="com.example.demo.entity.GakuseiExample" resultType="java.lang.Long">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Thu Oct 23 21:46:57 JST 2025.
    -->
    select count(*) from gakusei
    <if test="_parameter != null">
      <include refid="Example_Where_Clause" />
    </if>
  </select>
  <update id="updateByExampleSelective" parameterType="map">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Thu Oct 23 21:46:57 JST 2025.
    -->
    update gakusei
    <set>
      <if test="row.gakuseiId != null">
        gakusei_id = #{row.gakuseiId,jdbcType=INTEGER},
      </if>
      <if test="row.kurasuId != null">
        kurasu_id = #{row.kurasuId,jdbcType=INTEGER},
      </if>
      <if test="row.namae != null">
        namae = #{row.namae,jdbcType=VARCHAR},
      </if>
      <if test="row.seibetsu != null">
        seibetsu = #{row.seibetsu,jdbcType=VARCHAR},
      </if>
      <if test="row.seinengappi != null">
        seinengappi = #{row.seinengappi,jdbcType=VARCHAR},
      </if>
      <if test="row.saishuGakureki != null">
        saishu_gakureki = #{row.saishuGakureki,jdbcType=VARCHAR},
      </if>
      <if test="row.gogakuryoku != null">
        gogakuryoku = #{row.gogakuryoku,jdbcType=VARCHAR},
      </if>
      <if test="row.tensu != null">
        tensu = #{row.tensu,jdbcType=INTEGER},
      </if>
      <if test="row.hyouka != null">
        hyouka = #{row.hyouka,jdbcType=VARCHAR},
      </if>
      <if test="row.sonota != null">
        sonota = #{row.sonota,jdbcType=VARCHAR},
      </if>
      <if test="row.yobi1 != null">
        yobi1 = #{row.yobi1,jdbcType=VARCHAR},
      </if>
      <if test="row.yobi2 != null">
        yobi2 = #{row.yobi2,jdbcType=VARCHAR},
      </if>
      <if test="row.yobi3 != null">
        yobi3 = #{row.yobi3,jdbcType=VARCHAR},
      </if>
      <if test="row.deleteFlag != null">
        DELETE_FLAG = #{row.deleteFlag,jdbcType=INTEGER},
      </if>
    </set>
    <if test="example != null">
      <include refid="Update_By_Example_Where_Clause" />
    </if>
  </update>
  <update id="updateByExample" parameterType="map">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Thu Oct 23 21:46:57 JST 2025.
    -->
    update gakusei
    set gakusei_id = #{row.gakuseiId,jdbcType=INTEGER},
      kurasu_id = #{row.kurasuId,jdbcType=INTEGER},
      namae = #{row.namae,jdbcType=VARCHAR},
      seibetsu = #{row.seibetsu,jdbcType=VARCHAR},
      seinengappi = #{row.seinengappi,jdbcType=VARCHAR},
      saishu_gakureki = #{row.saishuGakureki,jdbcType=VARCHAR},
      gogakuryoku = #{row.gogakuryoku,jdbcType=VARCHAR},
      tensu = #{row.tensu,jdbcType=INTEGER},
      hyouka = #{row.hyouka,jdbcType=VARCHAR},
      sonota = #{row.sonota,jdbcType=VARCHAR},
      yobi1 = #{row.yobi1,jdbcType=VARCHAR},
      yobi2 = #{row.yobi2,jdbcType=VARCHAR},
      yobi3 = #{row.yobi3,jdbcType=VARCHAR},
      DELETE_FLAG = #{row.deleteFlag,jdbcType=INTEGER}
    <if test="example != null">
      <include refid="Update_By_Example_Where_Clause" />
    </if>
  </update>
  <update id="updateByPrimaryKeySelective" parameterType="com.example.demo.entity.Gakusei">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Thu Oct 23 21:46:57 JST 2025.
    -->
    update gakusei
    <set>
      <if test="kurasuId != null">
        kurasu_id = #{kurasuId,jdbcType=INTEGER},
      </if>
      <if test="namae != null">
        namae = #{namae,jdbcType=VARCHAR},
      </if>
      <if test="seibetsu != null">
        seibetsu = #{seibetsu,jdbcType=VARCHAR},
      </if>
      <if test="seinengappi != null">
        seinengappi = #{seinengappi,jdbcType=VARCHAR},
      </if>
      <if test="saishuGakureki != null">
        saishu_gakureki = #{saishuGakureki,jdbcType=VARCHAR},
      </if>
      <if test="gogakuryoku != null">
        gogakuryoku = #{gogakuryoku,jdbcType=VARCHAR},
      </if>
      <if test="tensu != null">
        tensu = #{tensu,jdbcType=INTEGER},
      </if>
      <if test="hyouka != null">
        hyouka = #{hyouka,jdbcType=VARCHAR},
      </if>
      <if test="sonota != null">
        sonota = #{sonota,jdbcType=VARCHAR},
      </if>
      <if test="yobi1 != null">
        yobi1 = #{yobi1,jdbcType=VARCHAR},
      </if>
      <if test="yobi2 != null">
        yobi2 = #{yobi2,jdbcType=VARCHAR},
      </if>
      <if test="yobi3 != null">
        yobi3 = #{yobi3,jdbcType=VARCHAR},
      </if>
      <if test="deleteFlag != null">
        DELETE_FLAG = #{deleteFlag,jdbcType=INTEGER},
      </if>
    </set>
    where gakusei_id = #{gakuseiId,jdbcType=INTEGER}
  </update>
  <update id="updateByPrimaryKey" parameterType="com.example.demo.entity.Gakusei">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Thu Oct 23 21:46:57 JST 2025.
    -->
    update gakusei
    set kurasu_id = #{kurasuId,jdbcType=INTEGER},
      namae = #{namae,jdbcType=VARCHAR},
      seibetsu = #{seibetsu,jdbcType=VARCHAR},
      seinengappi = #{seinengappi,jdbcType=VARCHAR},
      saishu_gakureki = #{saishuGakureki,jdbcType=VARCHAR},
      gogakuryoku = #{gogakuryoku,jdbcType=VARCHAR},
      tensu = #{tensu,jdbcType=INTEGER},
      hyouka = #{hyouka,jdbcType=VARCHAR},
      sonota = #{sonota,jdbcType=VARCHAR},
      yobi1 = #{yobi1,jdbcType=VARCHAR},
      yobi2 = #{yobi2,jdbcType=VARCHAR},
      yobi3 = #{yobi3,jdbcType=VARCHAR},
      DELETE_FLAG = #{deleteFlag,jdbcType=INTEGER}
    where gakusei_id = #{gakuseiId,jdbcType=INTEGER}
  </update>
</mapper>
