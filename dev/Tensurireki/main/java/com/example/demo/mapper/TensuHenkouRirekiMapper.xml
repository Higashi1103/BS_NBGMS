<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper
	namespace="com.example.demo.mapper.TensuHenkouRirekiMapper">
	<resultMap id="BaseResultMap"
		type="com.example.demo.entity.TensuHenkouRireki">
		<!-- WARNING - @mbg.generated This element is automatically generated by 
			MyBatis Generator, do not modify. This element was generated on Thu Oct 23 
			21:11:02 JST 2025. -->
		<id column="rireki_id" jdbcType="INTEGER" property="rirekiId" />
		<result column="gakusei_id" jdbcType="INTEGER"
			property="gakuseiId" />
		<result column="kagen_tensu" jdbcType="VARCHAR"
			property="kagenTensu" />
		<result column="riyu_id" jdbcType="INTEGER" property="riyuId" />
		<result column="hassei_bi" jdbcType="VARCHAR"
			property="hasseiBi" />
		<result column="bikou" jdbcType="VARCHAR" property="bikou" />
		<result column="delete_flag" jdbcType="INTEGER"
			property="deleteFlag" />
		<result column="yobi_1" jdbcType="VARCHAR" property="yobi1" />
		<result column="yobi_2" jdbcType="VARCHAR" property="yobi2" />
		<result column="yobi_3" jdbcType="VARCHAR" property="yobi3" />
		<result column="tourokubi" jdbcType="TIMESTAMP"
			property="tourokubi" />
		<result column="tourokusya" jdbcType="VARCHAR"
			property="tourokusya" />
		<result column="kousinbi" jdbcType="TIMESTAMP"
			property="kousinbi" />
		<result column="kousinsya" jdbcType="VARCHAR"
			property="kousinsya" />

		<!-- 連動テーブル -->
		<result column="gutai_riyu" jdbcType="VARCHAR"
			property="gutaiRiyu" />
		<result column="namae" jdbcType="VARCHAR" property="namae" />
		<result column="kurasu_id" jdbcType="VARCHAR" property="kurasuId" />
		<result column="kurasu_namae" jdbcType="VARCHAR" property="kurasuNamae" />
	</resultMap>
	
	<!-- 基本フィールドリスト -->
	<sql id="baseColumnList">
        THR.rireki_id,
        THR.gakusei_id,
        GS.namae,
        THR.kagen_tensu,
        THR.riyu_id,
        KR.gutai_riyu,
        THR.hassei_bi,
        THR.bikou,
        THR.delete_flag,
        THR.yobi_1,
        THR.yobi_2,
        THR.yobi_3,
        THR.tourokubi,
        THR.tourokusya,
        THR.kousinbi,
        THR.kousinsya
    </sql>
    
    <!-- あいまい名前検索 -->
    <resultMap id="GakuseiResultMap" type="com.example.demo.entity.TensuHenkouRireki">
        <result column="gakusei_id" jdbcType="INTEGER" property="gakuseiId"/>
        <result column="namae" jdbcType="VARCHAR" property="namae"/>
        <result column="kurasu_id" jdbcType="VARCHAR" property="kurasuId" />
		<result column="kurasu_namae" jdbcType="VARCHAR" property="kurasuNamae" />
    </resultMap>

	<select id="findAll" resultMap="BaseResultMap">
        SELECT
            <include refid="baseColumnList"/>
        FROM tensu_henkou_rireki THR
        LEFT JOIN gakusei GS ON THR.gakusei_id = GS.gakusei_id
        LEFT JOIN kagen_riyu KR ON THR.riyu_id = KR.riyu_id
        WHERE THR.delete_flag = 0
        ORDER BY THR.gakusei_id DESC
    </select>

	<select id="findByGakuseiId" parameterType="int" resultMap="BaseResultMap">
        SELECT 
        	<include refid="baseColumnList"/>
        FROM tensu_henkou_rireki THR
        LEFT JOIN gakusei GS ON THR.gakusei_id = GS.gakusei_id
        LEFT JOIN kagen_riyu KR ON THR.riyu_id = KR.riyu_id
        WHERE THR.gakusei_id = #{gakuseiId} AND THR.delete_flag = 0
        ORDER BY THR.rireki_id DESC
    </select>
    
    <select id="findByRirekiId" parameterType="int" resultMap="BaseResultMap">
        SELECT 
        	<include refid="baseColumnList"/>
        FROM tensu_henkou_rireki THR
        LEFT JOIN gakusei GS ON THR.gakusei_id = GS.gakusei_id
        LEFT JOIN kagen_riyu KR ON THR.riyu_id = KR.riyu_id
        WHERE THR.rireki_id = #{rirekiId} AND THR.delete_flag = 0
    </select>

 	<select id="findByNamaeContaining" parameterType="String" resultMap="GakuseiResultMap">
        SELECT gakusei_id, namae ,kurasu_namae
        FROM gakusei GS
        LEFT JOIN kurasu_info KS ON GS.kurasu_id = KS.kurasu_id
        WHERE namae LIKE CONCAT('%', #{namae}, '%')
       	ORDER BY KS.kurasu_id DESC
    </select>

	<update id="updateTensu"
		parameterType="com.example.demo.entity.TensuHenkouRireki">
		UPDATE tensu_henkou_rireki
		SET
		gakusei_id = #{newGakuseiId},
		kagen_tensu = #{kagenTensu},
		riyu_id = #{riyuId},
		hassei_bi = #{hasseiBi},
		bikou = #{bikou},
		kousinbi = NOW(),
		kousinsya = 'admin'
		WHERE rireki_id = #{rirekiId}
	</update>

	<update id="updateDeleteFlag"
		parameterType="com.example.demo.entity.TensuHenkouRireki">
		UPDATE tensu_henkou_rireki
		SET delete_flag = #{deleteFlag}
		WHERE rireki_id = #{rirekiId}
	</update>

	<insert id="insertTensuRecord"
		parameterType="com.example.demo.entity.TensuHenkouRireki">
		INSERT INTO tensu_henkou_rireki (
		gakusei_id, 
		kagen_tensu, 
		riyu_id,
		hassei_bi, 
		bikou, 
		tourokubi, 
		tourokusya)
		VALUES (
		#{gakuseiId}, 
		#{kagenTensu}, 
		#{riyuId},
		#{hasseiBi},
		#{bikou}, 
		NOW(), 
		'admin')
	</insert>

	<sql id="Example_Where_Clause">
		<!-- WARNING - @mbg.generated This element is automatically generated by 
			MyBatis Generator, do not modify. This element was generated on Thu Oct 23 
			21:11:02 JST 2025. -->
		<where>
			<foreach collection="oredCriteria" item="criteria"
				separator="or">
				<if test="criteria.valid">
					<trim prefix="(" prefixOverrides="and" suffix=")">
						<foreach collection="criteria.criteria" item="criterion">
							<choose>
								<when test="criterion.noValue">
									and ${criterion.condition}
								</when>
								<when test="criterion.singleValue">
									and ${criterion.condition} #{criterion.value}
								</when>
								<when test="criterion.betweenValue">
									and ${criterion.condition} #{criterion.value}
									and
									#{criterion.secondValue}
								</when>
								<when test="criterion.listValue">
									and ${criterion.condition}
									<foreach close=")" collection="criterion.value"
										item="listItem" open="(" separator=",">
										#{listItem}
									</foreach>
								</when>
							</choose>
						</foreach>
					</trim>
				</if>
			</foreach>
		</where>
	</sql>
	<sql id="Update_By_Example_Where_Clause">
		<!-- WARNING - @mbg.generated This element is automatically generated by 
			MyBatis Generator, do not modify. This element was generated on Thu Oct 23 
			21:11:02 JST 2025. -->
		<where>
			<foreach collection="example.oredCriteria" item="criteria"
				separator="or">
				<if test="criteria.valid">
					<trim prefix="(" prefixOverrides="and" suffix=")">
						<foreach collection="criteria.criteria" item="criterion">
							<choose>
								<when test="criterion.noValue">
									and ${criterion.condition}
								</when>
								<when test="criterion.singleValue">
									and ${criterion.condition} #{criterion.value}
								</when>
								<when test="criterion.betweenValue">
									and ${criterion.condition} #{criterion.value}
									and
									#{criterion.secondValue}
								</when>
								<when test="criterion.listValue">
									and ${criterion.condition}
									<foreach close=")" collection="criterion.value"
										item="listItem" open="(" separator=",">
										#{listItem}
									</foreach>
								</when>
							</choose>
						</foreach>
					</trim>
				</if>
			</foreach>
		</where>
	</sql>
	<sql id="Base_Column_List">
		<!-- WARNING - @mbg.generated This element is automatically generated by 
			MyBatis Generator, do not modify. This element was generated on Thu Oct 23 
			21:11:02 JST 2025. -->
		rireki_id, gakusei_id, kagen_tensu, riyu_id, hassei_bi, bikou,
		delete_flag, yobi_1,
		yobi_2, yobi_3, tourokubi, tourokusya, kousinbi,
		kousinsya
	</sql>
	<select id="selectByExample"
		parameterType="com.example.demo.entity.TensuHenkouRirekiExample"
		resultMap="BaseResultMap">
		<!-- WARNING - @mbg.generated This element is automatically generated by 
			MyBatis Generator, do not modify. This element was generated on Thu Oct 23 
			21:11:02 JST 2025. -->
		select
		<if test="distinct">
			distinct
		</if>
		<include refid="Base_Column_List" />
		from tensu_henkou_rireki
		<if test="_parameter != null">
			<include refid="Example_Where_Clause" />
		</if>
		<if test="orderByClause != null">
			order by ${orderByClause}
		</if>
	</select>
	<select id="selectByPrimaryKey"
		parameterType="java.lang.Integer" resultMap="BaseResultMap">
		<!-- WARNING - @mbg.generated This element is automatically generated by 
			MyBatis Generator, do not modify. This element was generated on Thu Oct 23 
			21:11:02 JST 2025. -->
		select
		<include refid="Base_Column_List" />
		from tensu_henkou_rireki
		where rireki_id = #{rirekiId,jdbcType=INTEGER}
	</select>
	<delete id="deleteByPrimaryKey"
		parameterType="java.lang.Integer">
		<!-- WARNING - @mbg.generated This element is automatically generated by 
			MyBatis Generator, do not modify. This element was generated on Thu Oct 23 
			21:11:02 JST 2025. -->
		delete from tensu_henkou_rireki
		where rireki_id =
		#{rirekiId,jdbcType=INTEGER}
	</delete>
	<delete id="deleteByExample"
		parameterType="com.example.demo.entity.TensuHenkouRirekiExample">
		<!-- WARNING - @mbg.generated This element is automatically generated by 
			MyBatis Generator, do not modify. This element was generated on Thu Oct 23 
			21:11:02 JST 2025. -->
		delete from tensu_henkou_rireki
		<if test="_parameter != null">
			<include refid="Example_Where_Clause" />
		</if>
	</delete>
	<insert id="insert"
		parameterType="com.example.demo.entity.TensuHenkouRireki">
		<!-- WARNING - @mbg.generated This element is automatically generated by 
			MyBatis Generator, do not modify. This element was generated on Thu Oct 23 
			21:11:02 JST 2025. -->
		insert into tensu_henkou_rireki (rireki_id, gakusei_id, kagen_tensu,
		riyu_id, hassei_bi, bikou,
		delete_flag, yobi_1, yobi_2,
		yobi_3,
		tourokubi, tourokusya,
		kousinbi, kousinsya)
		values
		(#{rirekiId,jdbcType=INTEGER}, #{gakuseiId,jdbcType=VARCHAR},
		#{kagenTensu,jdbcType=VARCHAR},
		#{riyuId,jdbcType=INTEGER},
		#{hasseiBi,jdbcType=VARCHAR}, #{bikou,jdbcType=VARCHAR},
		#{deleteFlag,jdbcType=INTEGER}, #{yobi1,jdbcType=VARCHAR},
		#{yobi2,jdbcType=VARCHAR},
		#{yobi3,jdbcType=VARCHAR},
		#{tourokubi,jdbcType=TIMESTAMP}, #{tourokusya,jdbcType=VARCHAR},
		#{kousinbi,jdbcType=TIMESTAMP}, #{kousinsya,jdbcType=VARCHAR})
	</insert>
	<insert id="insertSelective"
		parameterType="com.example.demo.entity.TensuHenkouRireki">
		<!-- WARNING - @mbg.generated This element is automatically generated by 
			MyBatis Generator, do not modify. This element was generated on Thu Oct 23 
			21:11:02 JST 2025. -->
		insert into tensu_henkou_rireki
		<trim prefix="(" suffix=")" suffixOverrides=",">
			<if test="rirekiId != null">
				rireki_id,
			</if>
			<if test="gakuseiId != null">
				gakusei_id,
			</if>
			<if test="kagenTensu != null">
				kagen_tensu,
			</if>
			<if test="riyuId != null">
				riyu_id,
			</if>
			<if test="hasseiBi != null">
				hassei_bi,
			</if>
			<if test="bikou != null">
				bikou,
			</if>
			<if test="deleteFlag != null">
				delete_flag,
			</if>
			<if test="yobi1 != null">
				yobi_1,
			</if>
			<if test="yobi2 != null">
				yobi_2,
			</if>
			<if test="yobi3 != null">
				yobi_3,
			</if>
			<if test="tourokubi != null">
				tourokubi,
			</if>
			<if test="tourokusya != null">
				tourokusya,
			</if>
			<if test="kousinbi != null">
				kousinbi,
			</if>
			<if test="kousinsya != null">
				kousinsya,
			</if>
		</trim>
		<trim prefix="values (" suffix=")" suffixOverrides=",">
			<if test="rirekiId != null">
				#{rirekiId,jdbcType=INTEGER},
			</if>
			<if test="gakuseiId != null">
				#{gakuseiId,jdbcType=VARCHAR},
			</if>
			<if test="kagenTensu != null">
				#{kagenTensu,jdbcType=VARCHAR},
			</if>
			<if test="riyuId != null">
				#{riyuId,jdbcType=INTEGER},
			</if>
			<if test="hasseiBi != null">
				#{hasseiBi,jdbcType=VARCHAR},
			</if>
			<if test="bikou != null">
				#{bikou,jdbcType=VARCHAR},
			</if>
			<if test="deleteFlag != null">
				#{deleteFlag,jdbcType=INTEGER},
			</if>
			<if test="yobi1 != null">
				#{yobi1,jdbcType=VARCHAR},
			</if>
			<if test="yobi2 != null">
				#{yobi2,jdbcType=VARCHAR},
			</if>
			<if test="yobi3 != null">
				#{yobi3,jdbcType=VARCHAR},
			</if>
			<if test="tourokubi != null">
				#{tourokubi,jdbcType=TIMESTAMP},
			</if>
			<if test="tourokusya != null">
				#{tourokusya,jdbcType=VARCHAR},
			</if>
			<if test="kousinbi != null">
				#{kousinbi,jdbcType=TIMESTAMP},
			</if>
			<if test="kousinsya != null">
				#{kousinsya,jdbcType=VARCHAR},
			</if>
		</trim>
	</insert>
	<select id="countByExample"
		parameterType="com.example.demo.entity.TensuHenkouRirekiExample"
		resultType="java.lang.Long">
		<!-- WARNING - @mbg.generated This element is automatically generated by 
			MyBatis Generator, do not modify. This element was generated on Thu Oct 23 
			21:11:02 JST 2025. -->
		select count(*) from tensu_henkou_rireki
		<if test="_parameter != null">
			<include refid="Example_Where_Clause" />
		</if>
	</select>
	<update id="updateByExampleSelective" parameterType="map">
		<!-- WARNING - @mbg.generated This element is automatically generated by 
			MyBatis Generator, do not modify. This element was generated on Thu Oct 23 
			21:11:02 JST 2025. -->
		update tensu_henkou_rireki
		<set>
			<if test="row.rirekiId != null">
				rireki_id = #{row.rirekiId,jdbcType=INTEGER},
			</if>
			<if test="row.gakuseiId != null">
				gakusei_id = #{row.gakuseiId,jdbcType=VARCHAR},
			</if>
			<if test="row.kagenTensu != null">
				kagen_tensu = #{row.kagenTensu,jdbcType=VARCHAR},
			</if>
			<if test="row.riyuId != null">
				riyu_id = #{row.riyuId,jdbcType=INTEGER},
			</if>
			<if test="row.hasseiBi != null">
				hassei_bi = #{row.hasseiBi,jdbcType=VARCHAR},
			</if>
			<if test="row.bikou != null">
				bikou = #{row.bikou,jdbcType=VARCHAR},
			</if>
			<if test="row.deleteFlag != null">
				delete_flag = #{row.deleteFlag,jdbcType=INTEGER},
			</if>
			<if test="row.yobi1 != null">
				yobi_1 = #{row.yobi1,jdbcType=VARCHAR},
			</if>
			<if test="row.yobi2 != null">
				yobi_2 = #{row.yobi2,jdbcType=VARCHAR},
			</if>
			<if test="row.yobi3 != null">
				yobi_3 = #{row.yobi3,jdbcType=VARCHAR},
			</if>
			<if test="row.tourokubi != null">
				tourokubi = #{row.tourokubi,jdbcType=TIMESTAMP},
			</if>
			<if test="row.tourokusya != null">
				tourokusya = #{row.tourokusya,jdbcType=VARCHAR},
			</if>
			<if test="row.kousinbi != null">
				kousinbi = #{row.kousinbi,jdbcType=TIMESTAMP},
			</if>
			<if test="row.kousinsya != null">
				kousinsya = #{row.kousinsya,jdbcType=VARCHAR},
			</if>
		</set>
		<if test="example != null">
			<include refid="Update_By_Example_Where_Clause" />
		</if>
	</update>
	<update id="updateByExample" parameterType="map">
		<!-- WARNING - @mbg.generated This element is automatically generated by 
			MyBatis Generator, do not modify. This element was generated on Thu Oct 23 
			21:11:02 JST 2025. -->
		update tensu_henkou_rireki
		set rireki_id =
		#{row.rirekiId,jdbcType=INTEGER},
		gakusei_id =
		#{row.gakuseiId,jdbcType=VARCHAR},
		kagen_tensu =
		#{row.kagenTensu,jdbcType=VARCHAR},
		riyu_id =
		#{row.riyuId,jdbcType=INTEGER},
		hassei_bi =
		#{row.hasseiBi,jdbcType=VARCHAR},
		bikou =
		#{row.bikou,jdbcType=VARCHAR},
		delete_flag =
		#{row.deleteFlag,jdbcType=INTEGER},
		yobi_1 =
		#{row.yobi1,jdbcType=VARCHAR},
		yobi_2 = #{row.yobi2,jdbcType=VARCHAR},
		yobi_3 = #{row.yobi3,jdbcType=VARCHAR},
		tourokubi =
		#{row.tourokubi,jdbcType=TIMESTAMP},
		tourokusya =
		#{row.tourokusya,jdbcType=VARCHAR},
		kousinbi =
		#{row.kousinbi,jdbcType=TIMESTAMP},
		kousinsya =
		#{row.kousinsya,jdbcType=VARCHAR}
		<if test="example != null">
			<include refid="Update_By_Example_Where_Clause" />
		</if>
	</update>
	<update id="updateByPrimaryKeySelective"
		parameterType="com.example.demo.entity.TensuHenkouRireki">
		<!-- WARNING - @mbg.generated This element is automatically generated by 
			MyBatis Generator, do not modify. This element was generated on Thu Oct 23 
			21:11:02 JST 2025. -->
		update tensu_henkou_rireki
		<set>
			<if test="gakuseiId != null">
				gakusei_id = #{gakuseiId,jdbcType=VARCHAR},
			</if>
			<if test="kagenTensu != null">
				kagen_tensu = #{kagenTensu,jdbcType=VARCHAR},
			</if>
			<if test="riyuId != null">
				riyu_id = #{riyuId,jdbcType=INTEGER},
			</if>
			<if test="hasseiBi != null">
				hassei_bi = #{hasseiBi,jdbcType=VARCHAR},
			</if>
			<if test="bikou != null">
				bikou = #{bikou,jdbcType=VARCHAR},
			</if>
			<if test="deleteFlag != null">
				delete_flag = #{deleteFlag,jdbcType=INTEGER},
			</if>
			<if test="yobi1 != null">
				yobi_1 = #{yobi1,jdbcType=VARCHAR},
			</if>
			<if test="yobi2 != null">
				yobi_2 = #{yobi2,jdbcType=VARCHAR},
			</if>
			<if test="yobi3 != null">
				yobi_3 = #{yobi3,jdbcType=VARCHAR},
			</if>
			<if test="tourokubi != null">
				tourokubi = #{tourokubi,jdbcType=TIMESTAMP},
			</if>
			<if test="tourokusya != null">
				tourokusya = #{tourokusya,jdbcType=VARCHAR},
			</if>
			<if test="kousinbi != null">
				kousinbi = #{kousinbi,jdbcType=TIMESTAMP},
			</if>
			<if test="kousinsya != null">
				kousinsya = #{kousinsya,jdbcType=VARCHAR},
			</if>
		</set>
		where rireki_id = #{rirekiId,jdbcType=INTEGER}
	</update>
	<update id="updateByPrimaryKey"
		parameterType="com.example.demo.entity.TensuHenkouRireki">
		<!-- WARNING - @mbg.generated This element is automatically generated by 
			MyBatis Generator, do not modify. This element was generated on Thu Oct 23 
			21:11:02 JST 2025. -->
		update tensu_henkou_rireki
		set gakusei_id =
		#{gakuseiId,jdbcType=VARCHAR},
		kagen_tensu =
		#{kagenTensu,jdbcType=VARCHAR},
		riyu_id = #{riyuId,jdbcType=INTEGER},
		hassei_bi = #{hasseiBi,jdbcType=VARCHAR},
		bikou =
		#{bikou,jdbcType=VARCHAR},
		delete_flag =
		#{deleteFlag,jdbcType=INTEGER},
		yobi_1 = #{yobi1,jdbcType=VARCHAR},
		yobi_2 = #{yobi2,jdbcType=VARCHAR},
		yobi_3 = #{yobi3,jdbcType=VARCHAR},
		tourokubi = #{tourokubi,jdbcType=TIMESTAMP},
		tourokusya =
		#{tourokusya,jdbcType=VARCHAR},
		kousinbi =
		#{kousinbi,jdbcType=TIMESTAMP},
		kousinsya =
		#{kousinsya,jdbcType=VARCHAR}
		where rireki_id =
		#{rirekiId,jdbcType=INTEGER}
	</update>
</mapper>